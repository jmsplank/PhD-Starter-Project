* Magnetic Coplanarity
** Equation
  Equation for Magnetic Coplanarity:
  $\hat{n}_{MC}=\frac{(B_d \times B_u) \times \Delta B}{|(B_d \times B_u) \times \Delta B|}$
** Notes on minimising residual from ideal
   Ideal normal vector is (0.88 0.46 -0.11) from Johlander paper
*** Results from Looping
    #+begin_src shell
Using first and last 500 indices to average:
    Corresponds to 11:44:15+3.9s and 11:45:10-3.9s
    n_MC:        (0.7362718 0.50658697 -0.44863513)
    Residual:    -0.44

Using first and last 638 indices to average:
    Corresponds to 11:44:15+5.0s and 11:45:10-5.0s
    n_MC:        (0.8154717 0.49784094 -0.29522914)
    Residual:    -0.21

Using first and last 777 indices to average:
    Corresponds to 11:44:15+6.1s and 11:45:10-6.1s
    n_MC:        (0.7679669 0.48145893 -0.4224028)
    Residual:    -0.40

Using first and last 916 indices to average:
    Corresponds to 11:44:15+7.2s and 11:45:10-7.1s
    n_MC:        (0.7041486 0.47894573 -0.52420014)
    Residual:    -0.57

Using first and last 1055 indices to average:
    Corresponds to 11:44:15+8.2s and 11:45:10-8.2s
    n_MC:        (0.708252 0.46660572 -0.5297719)
    Residual:    -0.58

Using first and last 1194 indices to average:
    Corresponds to 11:44:15+9.3s and 11:45:10-9.3s
    n_MC:        (0.788785 0.46595773 -0.4008761)
    Residual:    -0.38

Using first and last 1333 indices to average:
    Corresponds to 11:44:15+10.4s and 11:45:10-10.4s
    n_MC:        (0.734462 0.4751745 -0.4845356)
    Residual:    -0.50

Using first and last 1472 indices to average:
    Corresponds to 11:44:15+11.5s and 11:45:10-11.5s
    n_MC:        (0.75895554 0.4661847 -0.45459682)
    Residual:    -0.46

Using first and last 1611 indices to average:
    Corresponds to 11:44:15+12.6s and 11:45:10-12.6s
    n_MC:        (0.7713671 0.4510707 -0.44891885)
    Residual:    -0.46

Using first and last 1750 indices to average:
    Corresponds to 11:44:15+13.7s and 11:45:10-13.7s
    n_MC:        (0.82666683 0.4303664 -0.36250058)
    Residual:    -0.34 
    #+end_src
    Difficult to get good results from magnetic coplanarity.
    Defining a good result as one that matches Johlander paper
* Minimising residual
  By calculating the shock normal using various different methods
  and then taking the sum of the differences between the calculated
  normal + the result from the Johlander paper - generate a scalar
  residual metric that can be used to judge the quality of the
  calculation.

** Source
  #+begin_src bash
Using first and last 500 indices to average:
    Corresponds to 11:44:15+3.9s and 11:45:10-3.9s
    n_MC:            (0.736 0.507 -0.449)
        Residual:    -0.44
    n_MX1:           (0.887 0.444 -0.125)
        Residual:    -0.02
    n_MX2:           (0.888 0.444 -0.123)
        Residual:    -0.02
    n_MX3:           (0.888 0.443 -0.122)
        Residual:    -0.02

Using first and last 750 indices to average:
    Corresponds to 11:44:15+5.9s and 11:45:10-5.9s
    n_MC:            (0.797 0.485 -0.360)
        Residual:    -0.31
    n_MX1:           (0.890 0.435 -0.139)
        Residual:    -0.04
    n_MX2:           (0.890 0.434 -0.136)
        Residual:    -0.04
    n_MX3:           (0.891 0.434 -0.135)
        Residual:    -0.04

Using first and last 1000 indices to average:
    Corresponds to 11:44:15+7.8s and 11:45:10-7.8s
    n_MC:            (0.684 0.467 -0.560)
        Residual:    -0.64
    n_MX1:           (0.893 0.421 -0.156)
        Residual:    -0.07
    n_MX2:           (0.896 0.419 -0.149)
        Residual:    -0.06
    n_MX3:           (0.896 0.419 -0.145)
        Residual:    -0.06

Using first and last 1250 indices to average:
    Corresponds to 11:44:15+9.8s and 11:45:10-9.8s
    n_MC:            (0.777 0.467 -0.422)
        Residual:    -0.41
    n_MX1:           (0.894 0.419 -0.157)
        Residual:    -0.07
    n_MX2:           (0.896 0.417 -0.152)
        Residual:    -0.07
    n_MX3:           (0.897 0.417 -0.149)
        Residual:    -0.07

Using first and last 1500 indices to average:
    Corresponds to 11:44:15+11.7s and 11:45:10-11.7s
    n_MC:            (0.772 0.458 -0.441)
        Residual:    -0.44
    n_MX1:           (0.893 0.414 -0.177)
        Residual:    -0.10
    n_MX2:           (0.895 0.413 -0.171)
        Residual:    -0.09
    n_MX3:           (0.896 0.412 -0.168)
        Residual:    -0.09

Using first and last 1750 indices to average:
    Corresponds to 11:44:15+13.7s and 11:45:10-13.7s
    n_MC:            (0.827 0.430 -0.363)
        Residual:    -0.34
    n_MX1:           (0.899 0.395 -0.188)
        Residual:    -0.12
    n_MX2:           (0.901 0.393 -0.183)
        Residual:    -0.12
    n_MX3:           (0.902 0.393 -0.181)
        Residual:    -0.12

Using first and last 2000 indices to average:
    Corresponds to 11:44:15+15.6s and 11:45:10-15.6s
    n_MC:            (0.810 0.434 -0.394)
        Residual:    -0.38
    n_MX1:           (0.901 0.393 -0.182)
        Residual:    -0.12
    n_MX2:           (0.903 0.392 -0.176)
        Residual:    -0.11
    n_MX3:           (0.904 0.391 -0.173)
        Residual:    -0.11

Using first and last 2250 indices to average:
    Corresponds to 11:44:15+17.6s and 11:45:10-17.6s
    n_MC:            (0.779 0.434 -0.452)
        Residual:    -0.47
    n_MX1:           (0.905 0.389 -0.171)
        Residual:    -0.11
    n_MX2:           (0.908 0.387 -0.163)
        Residual:    -0.10
    n_MX3:           (0.909 0.386 -0.158)
        Residual:    -0.09

Using first and last 2500 indices to average:
    Corresponds to 11:44:15+19.5s and 11:45:10-19.5s
    n_MC:            (0.704 0.460 -0.541)
        Residual:    -0.61
    n_MX1:           (0.898 0.413 -0.153)
        Residual:    -0.07
    n_MX2:           (0.900 0.411 -0.144)
        Residual:    -0.06
    n_MX3:           (0.901 0.411 -0.140)
        Residual:    -0.06

Using first and last 2750 indices to average:
    Corresponds to 11:44:15+21.5s and 11:45:10-21.5s
    n_MC:            (0.644 0.451 -0.618)
        Residual:    -0.75
    n_MX1:           (0.896 0.415 -0.160)
        Residual:    -0.08
    n_MX2:           (0.898 0.413 -0.149)
        Residual:    -0.07
    n_MX3:           (0.900 0.412 -0.144)
        Residual:    -0.06
  #+end_src

** 

** Table of results
| upstream       | downstream     |  n_MC | n_MX3 | n_MX3 | n_MX3 |
|----------------+----------------+-------+-------+-------+-------|
| 11:44:15+3.9s  | 11:45:10-3.9s  | -0.44 | -0.02 | -0.02 | -0.02 |
| 11:44:15+5.9s  | 11:45:10-5.9s  | -0.31 | -0.04 | -0.04 | -0.04 |
| 11:44:15+7.8s  | 11:45:10-7.8s  | -0.64 | -0.07 | -0.06 | -0.06 |
| 11:44:15+9.8s  | 11:45:10-9.8s  | -0.41 | -0.07 | -0.07 | -0.07 |
| 11:44:15+11.7s | 11:45:10-11.7s | -0.44 | -0.10 | -0.09 | -0.09 |
| 11:44:15+13.7s | 11:45:10-13.7s | -0.34 | -0.12 | -0.12 | -0.12 |
| 11:44:15+15.6s | 11:45:10-15.6s | -0.38 | -0.12 | -0.11 | -0.11 |
| 11:44:15+17.6s | 11:45:10-17.6s | -0.47 | -0.11 | -0.10 | -0.09 |
| 11:44:15+19.5s | 11:45:10-19.5s | -0.61 | -0.07 | -0.06 | -0.06 |
| 11:44:15+21.5s | 11:45:10-21.5s | -0.75 | -0.08 | -0.07 | -0.06 |
